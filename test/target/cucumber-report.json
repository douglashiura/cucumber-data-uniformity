[
  {
    "line": 1,
    "elements": [
      {
        "start_timestamp": "2019-05-21T20:46:53.560Z",
        "line": 4,
        "name": "Check rules to apply",
        "description": "",
        "id": "ript-cli-utility;check-rules-to-apply",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 5,
            "name": "I have no iptables rules loaded",
            "match": {},
            "keyword": "Given "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 6,
            "name": "I run `ript rules diff examples/basic.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 7,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 8,
              "value": "iptables --table nat --new-chain basic-d\\w+\niptables --table nat --new-chain basic-s\\w+\niptables --table filter --new-chain basic-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 13,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@sudo"
          },
          {
            "name": "@timeout-10"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.583Z",
        "line": 16,
        "name": "Apply rules",
        "description": "",
        "id": "ript-cli-utility;apply-rules",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 17,
            "name": "I have no iptables rules loaded",
            "match": {},
            "keyword": "Given "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 18,
            "name": "I run `ript rules diff examples/basic.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 19,
            "name": "the output from \"ript rules diff examples/basic.rb\" should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 20,
              "value": "iptables --table nat --new-chain basic-d\\w+\niptables --table nat --new-chain basic-s\\w+\niptables --table filter --new-chain basic-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 25,
            "name": "I run `ript rules apply examples/basic.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 26,
            "name": "the output from \"ript rules diff examples/basic.rb\" should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 27,
              "value": "iptables --table nat --new-chain basic-d\\w+\niptables --table nat --new-chain basic-s\\w+\niptables --table filter --new-chain basic-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 32,
            "name": "I run `ript rules diff examples/basic.rb `",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 33,
            "name": "the output from \"ript rules diff examples/basic.rb \" should contain exactly:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 34,
              "value": ""
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 36,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@sudo"
          },
          {
            "name": "@timeout-10"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.598Z",
        "line": 39,
        "name": "Clean rules",
        "description": "",
        "id": "ript-cli-utility;clean-rules",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 40,
            "name": "I have no iptables rules loaded",
            "match": {},
            "keyword": "Given "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 41,
            "name": "I run `ript rules apply examples/preclean.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 42,
            "name": "the output from \"ript rules apply examples/preclean.rb\" should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 43,
              "value": "iptables --table filter --new-chain partition-a\niptables --table filter --insert INPUT 1 --jump partition-a\niptables --table filter --insert OUTPUT 1 --jump partition-a\niptables --table filter --insert FORWARD 1 --jump partition-a\niptables --table nat --new-chain partition-d\niptables --table nat --insert PREROUTING 1 --jump partition-d\niptables --table nat --new-chain partition-s\niptables --table nat --insert POSTROUTING 1 --jump partition-s\n\n\n# supercow-\\w+\niptables --table nat --new-chain supercow-d\\w+\niptables --table nat --new-chain supercow-s\\w+\niptables --table filter --new-chain supercow-a\\w+\niptables --table filter --append supercow-a\\w+ --protocol TCP --destination 172.29.2.2 --source 172.27.1.1 --jump ACCEPT\niptables --table filter --insert partition-a --destination 172.29.2.2 --jump supercow-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 61,
            "name": "I run `ript rules apply examples/postclean.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 62,
            "name": "the output from \"ript rules apply examples/postclean.rb\" should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 63,
              "value": "# supercow-\\w+\niptables --table nat --new-chain supercow-d\\w+\niptables --table nat --new-chain supercow-s\\w+\niptables --table filter --new-chain supercow-a\\w+\niptables --table filter --append supercow-a\\w+ --protocol TCP --destination 172.29.2.3 --source 172.27.1.2 --jump ACCEPT\niptables --table filter --insert partition-a --destination 172.29.2.3 --jump supercow-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 71,
            "name": "I run `ript rules diff examples/postclean.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 72,
            "name": "the output from \"ript rules diff examples/postclean.rb\" should contain exactly:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 73,
              "value": ""
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 75,
            "name": "I run `ript clean apply examples/postclean.rb `",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 76,
            "name": "the output from \"ript clean apply examples/postclean.rb \" should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 77,
              "value": "iptables --table filter --delete partition-a --destination 172.29.2.2/32 --jump supercow-a\\w+\niptables --table filter --flush supercow-a\\w+\niptables --table filter --delete-chain supercow-a\\w+\niptables --table nat --flush supercow-d\\w+\niptables --table nat --delete-chain supercow-d\\w+\niptables --table nat --flush supercow-s\\w+\niptables --table nat --delete-chain supercow-s\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 86,
            "name": "I run `ript clean diff examples/postclean.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 87,
            "name": "the output from \"ript clean diff examples/postclean.rb\" should contain exactly:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 88,
              "value": ""
            }
          }
        ],
        "tags": [
          {
            "name": "@sudo"
          },
          {
            "name": "@timeout-10"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.613Z",
        "line": 92,
        "name": "raw rules should only apply once",
        "description": "",
        "id": "ript-cli-utility;raw-rules-should-only-apply-once",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 93,
            "name": "I have no iptables rules loaded",
            "match": {},
            "keyword": "Given "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 94,
            "name": "I run `ript rules apply examples/raw.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 95,
            "name": "the output from \"ript rules apply examples/raw.rb\" should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 96,
              "value": "iptables --new-chain before-a"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 99,
            "name": "I run `ript rules diff examples/raw.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 100,
            "name": "the output from \"ript rules diff examples/raw.rb\" should contain exactly:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 101,
              "value": ""
            }
          }
        ],
        "tags": [
          {
            "name": "@sudo"
          },
          {
            "name": "@timeout-10"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.620Z",
        "line": 105,
        "name": "Rule saving works",
        "description": "",
        "id": "ript-cli-utility;rule-saving-works",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 106,
            "name": "I have no iptables rules loaded",
            "match": {},
            "keyword": "Given "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 107,
            "name": "I run `ript rules save`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 108,
            "name": "the output from \"ript rules save\" should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 109,
              "value": "\\*filter\n:INPUT ACCEPT \\[\\d+:\\d+\\]\n:FORWARD ACCEPT \\[\\d+:\\d+\\]\n:OUTPUT ACCEPT \\[\\d+:\\d+\\]\nCOMMIT"
            }
          }
        ],
        "tags": [
          {
            "name": "@sudo"
          },
          {
            "name": "@timeout-10"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.624Z",
        "line": 118,
        "name": "Flush rules",
        "description": "",
        "id": "ript-cli-utility;flush-rules",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 119,
            "name": "I have no iptables rules loaded",
            "match": {},
            "keyword": "Given "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 120,
            "name": "I run `ript rules flush`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 121,
            "name": "the output from \"ript rules flush\" should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 122,
              "value": "  iptables --flush --table filter\n  iptables --delete-chain --table filter\n  iptables --table filter --policy INPUT ACCEPT\n  iptables --table filter --policy FORWARD ACCEPT\n  iptables --table filter --policy OUTPUT ACCEPT\n\n  # Clean NAT\n  iptables --flush --table nat\n  iptables --delete-chain --table nat\n  iptables --table nat --policy PREROUTING ACCEPT\n  iptables --table nat --policy POSTROUTING ACCEPT\n  iptables --table nat --policy OUTPUT ACCEPT\n\n  # Clean mangle\n  iptables --flush --table mangle\n  iptables --delete-chain --table mangle\n  iptables --table mangle --policy PREROUTING ACCEPT\n  iptables --table mangle --policy POSTROUTING ACCEPT\n  iptables --table mangle --policy INPUT ACCEPT\n  iptables --table mangle --policy FORWARD ACCEPT\n  iptables --table mangle --policy OUTPUT ACCEPT"
            }
          }
        ],
        "tags": [
          {
            "name": "@sudo"
          },
          {
            "name": "@timeout-10"
          }
        ]
      }
    ],
    "name": "Ript cli utility",
    "description": "",
    "id": "ript-cli-utility",
    "keyword": "Feature",
    "uri": "file:resources/features/cli.feature",
    "tags": []
  },
  {
    "line": 1,
    "elements": [
      {
        "start_timestamp": "2019-05-21T20:46:53.628Z",
        "line": 7,
        "name": "Name errors - undefined method",
        "description": "",
        "id": "error-handling;name-errors---undefined-method",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 9,
            "name": "I run `ript rules generate examples/errors-undefined-method.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 10,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 11,
              "value": "You tried using the \u0027.+\u0027 method on line \\d+ in .+/errors-undefined-method.rb\nThis method doesn\u0027t exist in the DSL. Did you mean:\n\n - ports\n\nAborting."
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 19,
            "name": "I run `ript rules generate examples/errors-undefined-method-with-no-match.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 20,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 21,
              "value": "You tried using the \u0027.+\u0027 method on line \\d+ in .+/errors-undefined-method-with-no-match.rb\nThis method doesn\u0027t exist in the DSL. There aren\u0027t any other methods with similar names. :-\\(\nAborting."
            }
          }
        ],
        "tags": [
          {
            "name": "@errors"
          },
          {
            "name": "@name"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.631Z",
        "line": 28,
        "name": "Parse errors - duplicate partition name",
        "description": "",
        "id": "error-handling;parse-errors---duplicate-partition-name",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 30,
            "name": "I run `ript rules generate examples/duplicate-partition-names/`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 31,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 32,
              "value": "Error: Partition name \u0027\\w+\u0027 is already defined!"
            }
          }
        ],
        "tags": [
          {
            "name": "@errors"
          },
          {
            "name": "@parse"
          },
          {
            "name": "@duplicate"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.635Z",
        "line": 37,
        "name": "Parse errors - bad characters in partition name",
        "description": "",
        "id": "error-handling;parse-errors---bad-characters-in-partition-name",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 39,
            "name": "I run `ript rules generate examples/space-in-partition-name.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 40,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 41,
              "value": "Error: Partition name \u0027.+\u0027 can\u0027t contain whitespace."
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 44,
            "name": "I run `ript rules generate examples/dash-in-partition-name.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 45,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 46,
              "value": "Error: Partition name \u0027.+\u0027 can\u0027t contain dashes"
            }
          }
        ],
        "tags": [
          {
            "name": "@errors"
          },
          {
            "name": "@parse"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.641Z",
        "line": 51,
        "name": "Parse errors - partition name longer than  characters",
        "description": "",
        "id": "error-handling;parse-errors---partition-name-longer-than--characters",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 52,
            "name": "I run `ript rules generate examples/partition-name-longer-than-20-characters.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 53,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 54,
              "value": "Error: Partition name \u0027.+\u0027 cannot be longer than 20 characters."
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 57,
            "name": "I run `ript rules generate examples/partition-name-exactly-20-characters.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 58,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 59,
              "value": "name_exactly_20_char"
            }
          }
        ],
        "tags": [
          {
            "name": "@errors"
          },
          {
            "name": "@parse"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.645Z",
        "line": 65,
        "name": "Parse errors - spaces and dashes",
        "description": "",
        "id": "error-handling;parse-errors---spaces-and-dashes",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 66,
            "name": "I run `ript rules generate examples/space-in-partition-name.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 67,
            "name": "the output should contain:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 68,
              "value": "Partition name \u0027space in my name\u0027 can\u0027t contain whitespace"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 71,
            "name": "I run `ript rules generate examples/dash-in-partition-name.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 72,
            "name": "the output should contain:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 73,
              "value": " Partition name \u0027dash-in-my-name\u0027 can\u0027t contain dashes (\u0027-\u0027)"
            }
          }
        ],
        "tags": [
          {
            "name": "@errors"
          },
          {
            "name": "@parse"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.648Z",
        "line": 78,
        "name": "Parse errors - missing address definition",
        "description": "",
        "id": "error-handling;parse-errors---missing-address-definition",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 79,
            "name": "I run `ript rules generate examples/missing-address-definition-in-destination.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 80,
            "name": "the output should contain:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 81,
              "value": "Address \u0027barprod-web-02\u0027 (a destination) isn\u0027t defined"
            }
          }
        ],
        "tags": [
          {
            "name": "@errors"
          },
          {
            "name": "@parse"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.650Z",
        "line": 86,
        "name": "Parse errors - missing address definition",
        "description": "",
        "id": "error-handling;parse-errors---missing-address-definition",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 87,
            "name": "I run `ript rules generate examples/missing-address-definition-in-from.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 88,
            "name": "the output should contain:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 89,
              "value": "Address \u0027bad guy\u0027 (a from) isn\u0027t defined"
            }
          }
        ],
        "tags": [
          {
            "name": "@errors"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.652Z",
        "line": 94,
        "name": "Load errors - missing rule file",
        "description": "",
        "id": "error-handling;load-errors---missing-rule-file",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 95,
            "name": "I run `ript rules generate examples/non-existent-lalalalala.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 96,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 97,
              "value": "The specified rule file or directory \u0027examples/non-existent-lalalalala.rb\u0027 does not exist"
            }
          }
        ],
        "tags": [
          {
            "name": "@errors"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.654Z",
        "line": 102,
        "name": "Multiple partition definitions in the same file",
        "description": "",
        "id": "error-handling;multiple-partition-definitions-in-the-same-file",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 103,
            "name": "I run `ript rules generate examples/multiple-partitions-in-this-file.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 104,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 105,
              "value": "Multiple partition definitions are not permitted in the same file."
            }
          }
        ],
        "tags": [
          {
            "name": "@errors"
          },
          {
            "name": "@parse"
          }
        ]
      }
    ],
    "name": "Error handling",
    "description": "  To ensure that rules apply cleanly\n  Ript should validate user input\n  And fail gracefully",
    "id": "error-handling",
    "keyword": "Feature",
    "uri": "file:resources/features/dsl/errors.feature",
    "tags": []
  },
  {
    "line": 1,
    "elements": [
      {
        "start_timestamp": "2019-05-21T20:46:53.665Z",
        "line": 3,
        "name": "Basic partition",
        "description": "",
        "id": "ript-dsl;basic-partition",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 4,
            "name": "I run `ript rules generate examples/basic.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 5,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 6,
              "value": "iptables --table nat --new-chain basic-d\\w+\niptables --table nat --new-chain basic-s\\w+\niptables --table filter --new-chain basic-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 11,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.669Z",
        "line": 14,
        "name": "Drop someone",
        "description": "",
        "id": "ript-dsl;drop-someone",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 15,
            "name": "I run `ript rules generate examples/drop.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 16,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 17,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 22,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 23,
              "value": "iptables --table filter --insert partition-a --destination 172.23.0.95 --jump bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 26,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 27,
              "value": "iptables --table filter --append bar-a\\w+ --protocol TCP --destination 172.23.0.95 --source 127.0.0.1 --jump DROP"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 30,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@filter"
          },
          {
            "name": "@drop"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.673Z",
        "line": 33,
        "name": "Accept someone",
        "description": "",
        "id": "ript-dsl;accept-someone",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 34,
            "name": "I run `ript rules generate examples/accept.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 35,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 36,
              "value": "iptables --table nat --new-chain keepalived-d\\w+\niptables --table nat --new-chain keepalived-s\\w+\niptables --table filter --new-chain keepalived-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 41,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 42,
              "value": "iptables --table filter --insert partition-a --destination 224.0.0.0/8 --jump keepalived-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 45,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 46,
              "value": "iptables --table filter --append keepalived-a\\w+ --protocol vrrp --destination 224.0.0.0/8 --source 172.16.0.216 --jump ACCEPT\niptables --table filter --append keepalived-a\\w+ --protocol vrrp --destination 224.0.0.0/8 --source 172.16.0.217 --jump ACCEPT"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 50,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@filter"
          },
          {
            "name": "@accept"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.676Z",
        "line": 53,
        "name": "Accept someone with a specific port and interface",
        "description": "",
        "id": "ript-dsl;accept-someone-with-a-specific-port-and-interface",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 54,
            "name": "I run `ript rules generate examples/accept-with-specific-port-and-interface.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 55,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 56,
              "value": "iptables --table nat --new-chain keepalived-d\\w+\niptables --table nat --new-chain keepalived-s\\w+\niptables --table filter --new-chain keepalived-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 61,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 62,
              "value": "iptables --table filter --insert partition-a --destination 192.168.0.76 --jump keepalived-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 65,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 66,
              "value": "iptables --table filter --append keepalived-a\\w+ --in-interface vlan\\+ --protocol tcp --dport 22 --destination 192.168.0.76 --source 192.168.0.76 --jump ACCEPT"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 69,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@filter"
          },
          {
            "name": "@accept"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.680Z",
        "line": 72,
        "name": "Reject someone",
        "description": "",
        "id": "ript-dsl;reject-someone",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 73,
            "name": "I run `ript rules generate examples/reject.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 74,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 75,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 80,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 81,
              "value": "iptables --table filter --insert partition-a --destination 172.23.0.95 --jump bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 84,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 85,
              "value": "iptables --table filter --append bar-a\\w+ --protocol TCP --destination 172.23.0.95 --source 127.0.0.1 --jump REJECT"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 88,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@filter"
          },
          {
            "name": "@reject"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.688Z",
        "line": 91,
        "name": "Log someone",
        "description": "",
        "id": "ript-dsl;log-someone",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 92,
            "name": "I run `ript rules generate examples/log.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 93,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 94,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 99,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 100,
              "value": "iptables --table filter --insert partition-a --destination 172.23.0.95 --jump bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 103,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 104,
              "value": "iptables --table filter --append bar-a\\w+ --protocol TCP --destination 172.23.0.95 --source 127.0.0.1 --jump LOG"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 107,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@filter"
          },
          {
            "name": "@log"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.692Z",
        "line": 110,
        "name": "Accept a list of ports",
        "description": "",
        "id": "ript-dsl;accept-a-list-of-ports",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 111,
            "name": "I run `ript rules generate examples/accept-with-a-list-of-ports.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 112,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 113,
              "value": "iptables --table nat --new-chain keepalived-d\\w+\niptables --table nat --new-chain keepalived-s\\w+\niptables --table filter --new-chain keepalived-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 118,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 119,
              "value": "iptables --table filter --insert partition-a --destination 224.0.0.0/8 --jump keepalived-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 122,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 123,
              "value": "iptables --table filter --append keepalived-a\\w+ --protocol tcp --dport 80 --destination 224.0.0.0/8 --source 172.16.0.216 --jump ACCEPT\niptables --table filter --append keepalived-a\\w+ --protocol tcp --dport 8600:8900 --destination 224.0.0.0/8 --source 172.16.0.216 --jump ACCEPT"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 127,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@filter"
          },
          {
            "name": "@accept"
          },
          {
            "name": "@port-range"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.695Z",
        "line": 130,
        "name": "Accept multiple from and to",
        "description": "",
        "id": "ript-dsl;accept-multiple-from-and-to",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 131,
            "name": "I run `ript rules generate examples/accept-multiple-from-and-to.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 132,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 133,
              "value": "iptables --table nat --new-chain tootyfruity-d\\w+\niptables --table nat --new-chain tootyfruity-s\\w+\niptables --table filter --new-chain tootyfruity-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 138,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 139,
              "value": "iptables --table filter --insert partition-a --destination 192.168.0.1 --jump tootyfruity-a\\w+\niptables --table filter --insert partition-a --destination 192.168.0.2 --jump tootyfruity-a\\w+\niptables --table filter --insert partition-a --destination 192.168.0.3 --jump tootyfruity-a\\w+\niptables --table filter --insert partition-a --destination 192.168.0.4 --jump tootyfruity-a\\w+\niptables --table filter --insert partition-a --destination 192.168.0.5 --jump tootyfruity-a\\w+\niptables --table filter --insert partition-a --destination 192.168.0.6 --jump tootyfruity-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 147,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 148,
              "value": "iptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.1 --source 192.168.0.1 --jump ACCEPT\niptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.2 --source 192.168.0.1 --jump ACCEPT\niptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.3 --source 192.168.0.1 --jump ACCEPT\niptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.4 --source 192.168.0.1 --jump ACCEPT\niptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.5 --source 192.168.0.1 --jump ACCEPT\niptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.6 --source 192.168.0.1 --jump ACCEPT\niptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.1 --source 192.168.0.2 --jump ACCEPT\niptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.2 --source 192.168.0.2 --jump ACCEPT\niptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.3 --source 192.168.0.2 --jump ACCEPT\niptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.4 --source 192.168.0.2 --jump ACCEPT\niptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.5 --source 192.168.0.2 --jump ACCEPT\niptables --table filter --append tootyfruity-a\\w+ --protocol tcp --dport 22 --destination 192.168.0.6 --source 192.168.0.2 --jump ACCEPT"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 162,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@filter"
          },
          {
            "name": "@accept"
          },
          {
            "name": "@multiple"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.698Z",
        "line": 165,
        "name": "Accept someone without a specific from",
        "description": "",
        "id": "ript-dsl;accept-someone-without-a-specific-from",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 166,
            "name": "I run `ript rules generate examples/accept-without-specific-from.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 167,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 168,
              "value": "iptables --table nat --new-chain joeblogsco-d\\w+\niptables --table nat --new-chain joeblogsco-s\\w+\niptables --table filter --new-chain joeblogsco-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 173,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 174,
              "value": "iptables --table filter --append joeblogsco-a\\w+ --protocol TCP --dport 80 --destination 172.22.111.99 --source 0.0.0.0/0 --jump ACCEPT\niptables --table filter --append joeblogsco-a\\w+ --protocol TCP --dport 443 --destination 172.22.111.99 --source 0.0.0.0/0 --jump ACCEPT"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 178,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 179,
              "value": "iptables --table filter --insert partition-a --destination 172.22.111.99 --jump joeblogsco-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 182,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@filter"
          },
          {
            "name": "@accept"
          },
          {
            "name": "@regression"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.700Z",
        "line": 185,
        "name": "Always include protocol when specifying port",
        "description": "",
        "id": "ript-dsl;always-include-protocol-when-specifying-port",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 186,
            "name": "I generate rules for packet filtering",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 187,
            "name": "I should see a protocol specified when a port is specified",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@filter"
          },
          {
            "name": "@regression"
          }
        ]
      }
    ],
    "name": "Ript DSL",
    "description": "",
    "id": "ript-dsl",
    "keyword": "Feature",
    "uri": "file:resources/features/dsl/filter.feature",
    "tags": []
  },
  {
    "line": 1,
    "elements": [
      {
        "start_timestamp": "2019-05-21T20:46:53.703Z",
        "line": 7,
        "name": "Log and accept",
        "description": "",
        "id": "logging;log-and-accept",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 8,
            "name": "I run `ript rules generate examples/log-and-accept.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 9,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 10,
              "value": "iptables --table nat --new-chain keepalived-d\\w+\niptables --table nat --new-chain keepalived-s\\w+\niptables --table filter --new-chain keepalived-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 15,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 16,
              "value": "iptables --table filter --insert partition-a --destination 224.0.0.0/8 --jump keepalived-a\\w+\niptables --table filter --insert partition-a --destination 224.0.0.0/8 --jump LOG"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 20,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 21,
              "value": "iptables --table filter --append keepalived-a\\w+ --protocol vrrp --destination 224.0.0.0/8 --source 172.16.0.216 --jump LOG\niptables --table filter --append keepalived-a\\w+ --protocol vrrp --destination 224.0.0.0/8 --source 172.16.0.216 --jump ACCEPT\niptables --table filter --append keepalived-a\\w+ --protocol vrrp --destination 224.0.0.0/8 --source 172.16.0.217 --jump LOG\niptables --table filter --append keepalived-a\\w+ --protocol vrrp --destination 224.0.0.0/8 --source 172.16.0.217 --jump ACCEPT"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 27,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@log"
          },
          {
            "name": "@filter"
          },
          {
            "name": "@accept"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.707Z",
        "line": 30,
        "name": "Log and drop",
        "description": "",
        "id": "logging;log-and-drop",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 31,
            "name": "I run `ript rules generate examples/log-and-drop.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 32,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 33,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 38,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 39,
              "value": "iptables --table filter --insert partition-a --destination 172.23.0.95 --jump bar-a\\w+\niptables --table filter --insert partition-a --destination 172.23.0.95 --jump LOG"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 43,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 44,
              "value": "iptables --table filter --append bar-a\\w+ --protocol TCP --destination 172.23.0.95 --source 127.0.0.1 --jump LOG\niptables --table filter --append bar-a\\w+ --protocol TCP --destination 172.23.0.95 --source 127.0.0.1 --jump DROP"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 48,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@log"
          },
          {
            "name": "@filter"
          },
          {
            "name": "@drop"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.711Z",
        "line": 51,
        "name": "Logging complex DNAT",
        "description": "",
        "id": "logging;logging-complex-dnat",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 52,
            "name": "I run `ript rules generate examples/log-dnat.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 53,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 54,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 59,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 60,
              "value": "iptables --table nat --insert partition-d --destination 172.23.0.95 --jump bar-d\\w+\niptables --table nat --insert partition-d --destination 172.23.0.95 --jump LOG"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 64,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 65,
              "value": "iptables --table nat --append bar-d\\w+ --protocol TCP --destination 172.23.0.95 --dport 80 --jump LOG --to-destination 192.168.19.2\niptables --table nat --append bar-d\\w+ --protocol TCP --destination 172.23.0.95 --dport 80 --jump DNAT --to-destination 192.168.19.2\niptables --table filter --append bar-a\\w+ --protocol TCP --destination 192.168.19.2 --dport 80 --jump LOG\niptables --table filter --append bar-a\\w+ --protocol TCP --destination 192.168.19.2 --dport 80 --jump ACCEPT\niptables --table nat --append bar-d\\w+ --protocol TCP --destination 172.23.0.95 --dport 22 --jump LOG --to-destination 192.168.19.2\niptables --table nat --append bar-d\\w+ --protocol TCP --destination 172.23.0.95 --dport 22 --jump DNAT --to-destination 192.168.19.2\niptables --table filter --append bar-a\\w+ --protocol TCP --destination 192.168.19.2 --dport 22 --jump LOG\niptables --table filter --append bar-a\\w+ --protocol TCP --destination 192.168.19.2 --dport 22 --jump ACCEPT"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 75,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@log"
          },
          {
            "name": "@nat"
          },
          {
            "name": "@dnat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.715Z",
        "line": 78,
        "name": "Logging complex SNAT",
        "description": "",
        "id": "logging;logging-complex-snat",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 79,
            "name": "I run `ript rules generate examples/log-snat.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 80,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 81,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 86,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 87,
              "value": "iptables --table nat --append bar-s\\w+ --source 10.33.0.0/24 --jump LOG --to-source 172.23.0.95\niptables --table nat --append bar-s\\w+ --source 10.33.0.0/24 --jump SNAT --to-source 172.23.0.95\niptables --table filter --append bar-a\\w+ --source 10.33.0.0/24 --jump LOG\niptables --table filter --append bar-a\\w+ --source 10.33.0.0/24 --jump ACCEPT\niptables --table nat --append bar-s\\w+ --source 10.44.0.0/24 --jump LOG --to-source 172.23.0.95\niptables --table nat --append bar-s\\w+ --source 10.44.0.0/24 --jump SNAT --to-source 172.23.0.95\niptables --table filter --append bar-a\\w+ --source 10.44.0.0/24 --jump LOG\niptables --table filter --append bar-a\\w+ --source 10.44.0.0/24 --jump ACCEPT\niptables --table nat --append bar-s\\w+ --source 10.55.0.0/24 --jump LOG --to-source 172.23.0.95\niptables --table nat --append bar-s\\w+ --source 10.55.0.0/24 --jump SNAT --to-source 172.23.0.95\niptables --table filter --append bar-a\\w+ --source 10.55.0.0/24 --jump LOG\niptables --table filter --append bar-a\\w+ --source 10.55.0.0/24 --jump ACCEPT\niptables --table nat --insert partition-s --source 10.33.0.0/24 --jump bar-s\\w+\niptables --table nat --insert partition-s --source 10.33.0.0/24 --jump LOG\niptables --table nat --insert partition-s --source 10.44.0.0/24 --jump bar-s\\w+\niptables --table nat --insert partition-s --source 10.44.0.0/24 --jump LOG\niptables --table nat --insert partition-s --source 10.55.0.0/24 --jump bar-s\\w+\niptables --table nat --insert partition-s --source 10.55.0.0/24 --jump LOG\niptables --table filter --insert partition-a --source 10.33.0.0/24 --jump bar-a\\w+\niptables --table filter --insert partition-a --source 10.33.0.0/24 --jump LOG\niptables --table filter --insert partition-a --source 10.44.0.0/24 --jump bar-a\\w+\niptables --table filter --insert partition-a --source 10.44.0.0/24 --jump LOG\niptables --table filter --insert partition-a --source 10.55.0.0/24 --jump bar-a\\w+\niptables --table filter --insert partition-a --source 10.55.0.0/24 --jump LOG"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 113,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@log"
          },
          {
            "name": "@nat"
          },
          {
            "name": "@snat"
          }
        ]
      }
    ],
    "name": "Logging",
    "description": "  When debugging complex problems\n  A user may want to know\n  If certain rules are being used",
    "id": "logging",
    "keyword": "Feature",
    "uri": "file:resources/features/dsl/logging.feature",
    "tags": []
  },
  {
    "line": 1,
    "elements": [
      {
        "start_timestamp": "2019-05-21T20:46:53.717Z",
        "line": 3,
        "name": "Basic partition",
        "description": "",
        "id": "ript-dsl;basic-partition",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 4,
            "name": "I run `ript rules generate examples/basic.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 5,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 6,
              "value": "iptables --table nat --new-chain basic-d\\w+\niptables --table nat --new-chain basic-s\\w+\niptables --table filter --new-chain basic-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 11,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.720Z",
        "line": 14,
        "name": "Basic DNAT forward",
        "description": "",
        "id": "ript-dsl;basic-dnat-forward",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 15,
            "name": "I run `ript rules generate examples/forward-dnat.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 16,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 17,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 22,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 23,
              "value": "iptables --table nat --append bar-d\\w+ --protocol TCP --destination 172.23.0.95 --dport 80 --jump DNAT --to-destination 192.168.19.2\niptables --table filter --append bar-a\\w+ --protocol TCP --destination 192.168.19.2 --dport 80 --jump ACCEPT"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 27,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 28,
              "value": "iptables --table nat --insert partition-d --destination 172.23.0.95 --jump bar-d\\w+\niptables --table filter --insert partition-a --destination 192.168.19.2 --jump bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 32,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@dnat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.723Z",
        "line": 35,
        "name": "DNAT forward with multiple ports",
        "description": "",
        "id": "ript-dsl;dnat-forward-with-multiple-ports",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 36,
            "name": "I run `ript rules generate examples/forward-dnat-with-multiple-ports.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 37,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 38,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 43,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 44,
              "value": "iptables --table nat --insert partition-d --destination 172.23.0.95 --jump bar-d\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 47,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 48,
              "value": "iptables --table nat --append bar-d\\w+ --protocol TCP --destination 172.23.0.95 --dport 80 --jump DNAT --to-destination 192.168.19.2"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 51,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 52,
              "value": "iptables --table nat --append bar-d\\w+ --protocol TCP --destination 172.23.0.95 --dport 22 --jump DNAT --to-destination 192.168.19.2"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 55,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@dnat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.726Z",
        "line": 58,
        "name": "DNAT forward with source port to different destination port",
        "description": "",
        "id": "ript-dsl;dnat-forward-with-source-port-to-different-destination-port",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 59,
            "name": "I run `ript rules generate examples/forward-dnat-with-different-destination-port.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 60,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 61,
              "value": "iptables --table nat --new-chain foo-d\\w+\niptables --table nat --new-chain foo-s\\w+\niptables --table filter --new-chain foo-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 66,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 67,
              "value": "iptables --table nat --insert partition-d --destination 172.23.0.88 --jump foo-d\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 70,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 71,
              "value": "iptables --table nat --append foo-d\\w+ --protocol TCP --destination 172.23.0.88 --dport 22 --jump DNAT --to-destination 192.168.38.1:9876"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 74,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 75,
              "value": "iptables --table nat --insert partition-d --destination 172.23.0.90 --jump foo-d\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 78,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 79,
              "value": "iptables --table nat --append foo-d\\w+ --protocol TCP --destination 172.23.0.90 --dport 22 --jump DNAT --to-destination 192.168.38.2:9876\niptables --table filter --append foo-a\\w+ --protocol TCP --destination 192.168.38.2 --dport 9876 --jump ACCEPT\niptables --table nat --append foo-d\\w+ --protocol TCP --destination 172.23.0.90 --dport 443 --jump DNAT --to-destination 192.168.38.2:4443\niptables --table filter --append foo-a\\w+ --protocol TCP --destination 192.168.38.2 --dport 4443 --jump ACCEPT"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 85,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@dnat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.729Z",
        "line": 88,
        "name": "DNAT forward for multiple sources",
        "description": "",
        "id": "ript-dsl;dnat-forward-for-multiple-sources",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 89,
            "name": "I run `ript rules generate examples/forward-dnat-with-multiple-sources.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 90,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 91,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 96,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 97,
              "value": "iptables --table nat --append bar-d\\w+ --protocol TCP --destination 172.23.0.95 --dport 80 --jump DNAT --to-destination 192.168.27.88\niptables --table filter --append bar-a\\w+ --protocol TCP --destination 192.168.27.88 --dport 80 --jump ACCEPT\niptables --table nat --append bar-d\\w+ --protocol TCP --destination 172.23.0.96 --dport 80 --jump DNAT --to-destination 192.168.27.88\niptables --table nat --append bar-d\\w+ --protocol TCP --destination 172.23.0.97 --dport 80 --jump DNAT --to-destination 192.168.27.88"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 103,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 104,
              "value": "iptables --table nat --insert partition-d --destination 172.23.0.95 --jump bar-d\\w+\niptables --table nat --insert partition-d --destination 172.23.0.96 --jump bar-d\\w+\niptables --table nat --insert partition-d --destination 172.23.0.97 --jump bar-d\\w+\niptables --table filter --insert partition-a --destination 192.168.27.88 --jump bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 110,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@dnat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.731Z",
        "line": 113,
        "name": "DNAT forward with an explicit from",
        "description": "",
        "id": "ript-dsl;dnat-forward-with-an-explicit-from",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 114,
            "name": "I run `ript rules generate examples/forward-dnat-with-explicit-from.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 115,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 116,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 121,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 122,
              "value": "iptables --table nat --append bar-d\\w+ --protocol TCP --source 192.168.23.70/27 --destination 172.23.0.95 --dport 80 --jump DNAT --to-destination 192.168.27.66\niptables --table filter --append bar-a\\w+ --protocol TCP --destination 192.168.27.66 --dport 80 --jump ACCEPT\niptables --table nat --insert partition-d --destination 172.23.0.95 --jump bar-d\\w+\niptables --table filter --insert partition-a --destination 192.168.27.66 --jump bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 128,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@dnat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.734Z",
        "line": 131,
        "name": "DNAT forward with multiple froms",
        "description": "",
        "id": "ript-dsl;dnat-forward-with-multiple-froms",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 132,
            "name": "I run `ript rules generate examples/forward-dnat-with-multiple-froms.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 133,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 134,
              "value": "iptables --table nat --new-chain joeblogsco-d\\w+\niptables --table nat --new-chain joeblogsco-s\\w+\niptables --table filter --new-chain joeblogsco-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 139,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 140,
              "value": "iptables --table nat --append joeblogsco-d\\w+ --protocol TCP --source 1.2.3.4 --destination 172.19.10.99 --dport 80 --jump DNAT --to-destination 192.168.27.66\niptables --table filter --append joeblogsco-a\\w+ --protocol TCP --destination 192.168.27.66 --dport 80 --jump ACCEPT\niptables --table nat --append joeblogsco-d\\w+ --protocol TCP --source 4.5.6.7 --destination 172.19.10.99 --dport 80 --jump DNAT --to-destination 192.168.27.66\niptables --table nat --append joeblogsco-d\\w+ --protocol TCP --source 7.8.9.10 --destination 172.19.10.99 --dport 80 --jump DNAT --to-destination 192.168.27.66\niptables --table nat --insert partition-d --destination 172.19.10.99 --jump joeblogsco-d\\w+\niptables --table filter --insert partition-a --destination 192.168.27.66 --jump joeblogsco-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 148,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@dnat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.737Z",
        "line": 151,
        "name": "DNAT forward with an explicit from and ports",
        "description": "",
        "id": "ript-dsl;dnat-forward-with-an-explicit-from-and-ports",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 152,
            "name": "I run `ript rules generate examples/forward-dnat-with-explicit-from-and-ports.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 153,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 154,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 159,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 160,
              "value": "iptables --table nat --append bar-d\\w+ --protocol TCP --source 192.168.23.70/27 --destination 172.23.0.95 --dport 82 --jump DNAT --to-destination 192.168.27.66\niptables --table filter --append bar-a\\w+ --protocol TCP --destination 192.168.27.66 --dport 82 --jump ACCEPT\niptables --table nat --insert partition-d --destination 172.23.0.95 --jump bar-d\\w+\niptables --table filter --insert partition-a --destination 192.168.27.66 --jump bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 166,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@dnat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.739Z",
        "line": 169,
        "name": "DNAT forward with an explicit from and port mappings",
        "description": "",
        "id": "ript-dsl;dnat-forward-with-an-explicit-from-and-port-mappings",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 170,
            "name": "I run `ript rules generate examples/forward-dnat-with-explicit-from-and-port-mappings.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 171,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 172,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 177,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 178,
              "value": "iptables --table nat --append bar-d\\w+ --protocol TCP --source 192.168.23.70/27 --destination 172.23.0.95 --dport 139 --jump DNAT --to-destination 192.168.27.66:2011\niptables --table filter --append bar-a\\w+ --protocol TCP --destination 192.168.27.66 --dport 2011 --jump ACCEPT\niptables --table nat --insert partition-d --destination 172.23.0.95 --jump bar-d\\w+\niptables --table filter --insert partition-a --destination 192.168.27.66 --jump bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 184,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@dnat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.742Z",
        "line": 187,
        "name": "DNAT forward with explicit protocols",
        "description": "",
        "id": "ript-dsl;dnat-forward-with-explicit-protocols",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 188,
            "name": "I run `ript rules generate examples/forward-dnat-with-explicit-protocols.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 189,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 190,
              "value": "iptables --table nat --new-chain cpm-d\\w+\niptables --table nat --new-chain cpm-s\\w+\niptables --table filter --new-chain cpm-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 195,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 196,
              "value": "iptables --table nat --append cpm-d\\w+ --protocol udp --source 172.19.4.55 --destination 172.18.88.33 --dport 53 --jump DNAT --to-destination 192.168.0.133\niptables --table filter --append cpm-a\\w+ --protocol udp --destination 192.168.0.133 --dport 53 --jump ACCEPT\niptables --table nat --append cpm-d\\w+ --protocol tcp --source 172.19.4.55 --destination 172.18.88.33 --dport 53 --jump DNAT --to-destination 192.168.0.133\niptables --table filter --append cpm-a\\w+ --protocol tcp --destination 192.168.0.133 --dport 53 --jump ACCEPT\niptables --table nat --insert partition-d --destination 172.18.88.33 --jump cpm-d\\w+\niptables --table filter --insert partition-a --destination 192.168.0.133 --jump cpm-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 204,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@dnat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.745Z",
        "line": 208,
        "name": "Basic SNAT forward",
        "description": "",
        "id": "ript-dsl;basic-snat-forward",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 209,
            "name": "I run `ript rules generate examples/forward-snat.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 210,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 211,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 216,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 217,
              "value": "iptables --table nat --append bar-s\\w+ --source 10.30.0.0/24 --jump SNAT --to-source 172.23.0.95\niptables --table filter --append bar-a\\w+ --source 10.30.0.0/24 --jump ACCEPT\niptables --table nat --insert partition-s --source 10.30.0.0/24 --jump bar-s\\w+\niptables --table filter --insert partition-a --source 10.30.0.0/24 --jump bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 223,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@snat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.747Z",
        "line": 226,
        "name": "SNAT forward for multiple sources",
        "description": "",
        "id": "ript-dsl;snat-forward-for-multiple-sources",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 227,
            "name": "I run `ript rules generate examples/forward-snat-with-multiple-sources.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 228,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 229,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 234,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 235,
              "value": "iptables --table nat --append bar-s\\w+ --source 10.33.0.0/24 --jump SNAT --to-source 172.23.0.95\niptables --table filter --append bar-a\\w+ --source 10.33.0.0/24 --jump ACCEPT\niptables --table nat --append bar-s\\w+ --source 10.44.0.0/24 --jump SNAT --to-source 172.23.0.95\niptables --table filter --append bar-a\\w+ --source 10.44.0.0/24 --jump ACCEPT\niptables --table nat --append bar-s\\w+ --source 10.55.0.0/24 --jump SNAT --to-source 172.23.0.95\niptables --table filter --append bar-a\\w+ --source 10.55.0.0/24 --jump ACCEPT\niptables --table nat --insert partition-s --source 10.33.0.0/24 --jump bar-s\\w+\niptables --table nat --insert partition-s --source 10.44.0.0/24 --jump bar-s\\w+\niptables --table nat --insert partition-s --source 10.55.0.0/24 --jump bar-s\\w+\niptables --table filter --insert partition-a --source 10.33.0.0/24 --jump bar-a\\w+\niptables --table filter --insert partition-a --source 10.44.0.0/24 --jump bar-a\\w+\niptables --table filter --insert partition-a --source 10.55.0.0/24 --jump bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 249,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@snat"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.750Z",
        "line": 252,
        "name": "SNAT forward with an explicit from",
        "description": "",
        "id": "ript-dsl;snat-forward-with-an-explicit-from",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 253,
            "name": "I run `ript rules generate examples/forward-snat-with-explicit-from.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 254,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 255,
              "value": "iptables --table nat --new-chain bar-d\\w+\niptables --table nat --new-chain bar-s\\w+\niptables --table filter --new-chain bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 260,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 261,
              "value": "iptables --table nat --append bar-s\\w+ --source 10.55.0.45 --jump SNAT --to-source 172.24.0.99\niptables --table filter --append bar-a\\w+ --source 10.55.0.45 --jump ACCEPT\niptables --table nat --append bar-s\\w+ --source 10.55.0.0/24 --jump SNAT --to-source 172.23.0.95\niptables --table filter --append bar-a\\w+ --source 10.55.0.0/24 --jump ACCEPT\niptables --table nat --insert partition-s --source 10.55.0.45 --jump bar-s\\w+\niptables --table nat --insert partition-s --source 10.55.0.0/24 --jump bar-s\\w+\niptables --table filter --insert partition-a --source 10.55.0.45 --jump bar-a\\w+\niptables --table filter --insert partition-a --source 10.55.0.0/24 --jump bar-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 271,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@nat"
          },
          {
            "name": "@snat"
          }
        ]
      }
    ],
    "name": "Ript DSL",
    "description": "",
    "id": "ript-dsl",
    "keyword": "Feature",
    "uri": "file:resources/features/dsl/nat.feature",
    "tags": []
  },
  {
    "line": 1,
    "elements": [
      {
        "start_timestamp": "2019-05-21T20:46:53.751Z",
        "line": 7,
        "name": "Raw rules",
        "description": "",
        "id": "raw-iptables-rules;raw-rules",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 8,
            "name": "I run `ript rules generate examples/raw.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 9,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 10,
              "value": "# setup-\\w+"
            }
          }
        ],
        "tags": [
          {
            "name": "@raw"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.753Z",
        "line": 16,
        "name": "Raw rules validation",
        "description": "",
        "id": "raw-iptables-rules;raw-rules-validation",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 17,
            "name": "I run `ript rules generate examples/raw-with-flush.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 18,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 19,
              "value": "Error: partition boilerplate - you can\u0027t use raw rules that flush tables or chains!"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 22,
            "name": "I run `ript rules generate examples/raw-with-chain-deletion.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 23,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 24,
              "value": "Error: partition boilerplate - you can\u0027t use raw rules that delete chains!"
            }
          }
        ],
        "tags": [
          {
            "name": "@raw"
          },
          {
            "name": "@error"
          }
        ]
      }
    ],
    "name": "Raw iptables rules",
    "description": "  When implementing firewalls in complex environments\n  Sometimes an operator needs a more precise vocabulary\n  To express non-partition specific rules",
    "id": "raw-iptables-rules",
    "keyword": "Feature",
    "uri": "file:resources/features/dsl/raw.feature",
    "tags": []
  },
  {
    "line": 1,
    "elements": [
      {
        "start_timestamp": "2019-05-21T20:46:53.756Z",
        "line": 4,
        "name": "Partition chain is set up",
        "description": "",
        "id": "ript-setup;partition-chain-is-set-up",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 5,
            "name": "I have no iptables rules loaded",
            "match": {},
            "keyword": "Given "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 6,
            "name": "I run `ript rules diff examples/basic.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 7,
            "name": "the output should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 8,
              "value": "iptables --table filter --new-chain partition-a\niptables --table filter --insert INPUT 1 --jump partition-a\niptables --table filter --insert OUTPUT 1 --jump partition-a\niptables --table filter --insert FORWARD 1 --jump partition-a\niptables --table nat --new-chain partition-d\niptables --table nat --insert PREROUTING 1 --jump partition-d\niptables --table nat --new-chain partition-s\niptables --table nat --insert POSTROUTING 1 --jump partition-s\n\n\n# basic-\\w+\niptables --table nat --new-chain basic-d\\w+\niptables --table nat --new-chain basic-s\\w+\niptables --table filter --new-chain basic-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 24,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@sudo"
          },
          {
            "name": "@timeout-10"
          }
        ]
      },
      {
        "start_timestamp": "2019-05-21T20:46:53.760Z",
        "line": 27,
        "name": "Partition chain is only added once",
        "description": "",
        "id": "ript-setup;partition-chain-is-only-added-once",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "status": "undefined"
            },
            "line": 28,
            "name": "I have no iptables rules loaded",
            "match": {},
            "keyword": "Given "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 29,
            "name": "I run `ript rules apply examples/basic.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 30,
            "name": "the output from \"ript rules apply examples/basic.rb\" should match:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 31,
              "value": "iptables --table filter --new-chain partition-a\niptables --table filter --insert INPUT 1 --jump partition-a\niptables --table filter --insert OUTPUT 1 --jump partition-a\niptables --table filter --insert FORWARD 1 --jump partition-a\niptables --table nat --new-chain partition-d\niptables --table nat --insert PREROUTING 1 --jump partition-d\niptables --table nat --new-chain partition-s\niptables --table nat --insert POSTROUTING 1 --jump partition-s\n\n\n# basic-\\w+\niptables --table nat --new-chain basic-d\\w+\niptables --table nat --new-chain basic-s\\w+\niptables --table filter --new-chain basic-a\\w+"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 47,
            "name": "I run `ript rules apply examples/partition-name-exactly-20-characters.rb`",
            "match": {},
            "keyword": "When "
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 48,
            "name": "the output from \"ript rules apply examples/partition-name-exactly-20-characters.rb\" should contain exactly:",
            "match": {},
            "keyword": "Then ",
            "doc_string": {
              "line": 49,
              "value": "# name_exactly_20_char-f9964b\niptables --table nat --new-chain name_exactly_20_char-df9964b\niptables --table nat --new-chain name_exactly_20_char-sf9964b\niptables --table filter --new-chain name_exactly_20_char-af9964b\n\n\n"
            }
          },
          {
            "result": {
              "status": "undefined"
            },
            "line": 58,
            "name": "the created chain name in all tables should match",
            "match": {},
            "keyword": "Then "
          }
        ],
        "tags": [
          {
            "name": "@sudo"
          },
          {
            "name": "@timeout-10"
          }
        ]
      }
    ],
    "name": "Ript Setup",
    "description": "",
    "id": "ript-setup",
    "keyword": "Feature",
    "uri": "file:resources/features/setup.feature",
    "tags": []
  }
]